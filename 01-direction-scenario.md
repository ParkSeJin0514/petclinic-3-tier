# 🧭 방향성 및 시나리오

## 📋 프로젝트 개요

### 목적
소규모 온라인 쇼핑몰의 안정적인 서비스 운영을 위한 AWS 기반 3-Tier 아키텍처 구축

### 대상 서비스
- **업종**: 애완용품 쇼핑몰 (소규모)
- **일평균 방문자**: 300명
- **피크 타임**: 1,000 ~ 2,000명
- **월평균 주문**: 30건

### 프로젝트 정보
- **시작일**: 2025년 10월 1일
- **종료일**: 2025년 10월 2일
- **상태**: Completed
- **담당자**: 박세진, Seung Lo, 홍정호

---

## ✅ 동적 Auto Scaling 정책

### 기본 정책
시간대별 Auto Scaling 스케줄링과 동적 스케일링을 조합하여 운영합니다.

#### Scale-out 조건
- **CPU 사용률 50% 이상**: Scale-out 시작
- 트래픽 증가에 선제적으로 대응하여 서비스 품질 유지

#### Scale-in 조건
- **CPU 사용률 30% 이하**: Scale-in 시작
- 불필요한 리소스를 줄여 비용 최적화

#### 인스턴스 제한
- **최소 인스턴스**: 2대
  - 고가용성 보장
  - 단일 장애점(Single Point of Failure) 방지
  - 최소한의 서비스 연속성 유지
  
- **최대 인스턴스**: 8대
  - 비용 통제
  - 예상치 못한 트래픽 폭증에도 대응 가능
  - 과도한 확장 방지

---

## 📊 트래픽에 따른 시나리오 및 스케줄

### 1. 평상시 스케줄

#### 🌙 새벽/이른 아침 (00:00 ~ 09:00)
**최소 리소스 운영 구간**

- **WEB**: 2대 (최소 유지)
- **WAS**: 2대 (최소 유지)
- **이유**: 트래픽 최저, 비용 절감
- **특징**:
  - 서비스 가용성은 유지하되 비용 최소화
  - 야간 배치 작업 수행 시간대
  - 시스템 유지보수 권장 시간대

#### ☀️ 오전/오후/저녁 (09:00 ~ 18:50)
**정상 운영 구간**

- **WEB**: 2대
- **WAS**: 2대
- **동작**: 정상 운영
- **특징**:
  - 일반적인 업무 시간대
  - 평균 트래픽 처리
  - 동적 스케일링 대기 상태

#### 🌆 저녁 피크 대비 (18:50)
**사전 스케일 아웃 구간**

- **WEB**: 3대 → 4대 (스케줄 Scale-out)
- **WAS**: 3대 → 5대 (스케줄 Scale-out)
- **이유**: 퇴근 후 쇼핑 트래픽 대비
- **특징**:
  - 피크 타임 10분 전 사전 확장
  - 인스턴스 부팅 시간 고려한 선제적 대응
  - 사용자 경험 품질 저하 방지

#### 🔥 저녁 피크 (19:00 ~ 22:00)
**최대 트래픽 구간**

- **WEB**: 4~6대 (동적 조정)
- **WAS**: 5~7대 (동적 조정)
- **동작**: 일일 최대 트래픽
- **특징**:
  - 하루 중 가장 높은 트래픽 발생
  - 동적 Auto Scaling이 활발하게 작동
  - 실시간 모니터링 집중 시간대
  - 주요 비즈니스 이벤트 (주문, 결제) 집중

#### 🌙 야간 (22:00 ~ 24:00)
**점진적 축소 구간**

- **WEB**: 2~3대 (점진적 Scale-in)
- **WAS**: 2~3대 (점진적 Scale-in)
- **특징**:
  - 트래픽 감소에 따른 자원 회수
  - 급격한 축소가 아닌 점진적 축소로 안정성 확보
  - 자정 이후 최소 구성으로 전환 준비

---

## 📈 트래픽 패턴 분석

### 시간대별 예상 트래픽

| 시간대 | 예상 동시 접속자 | 트래픽 수준 | 비고 |
|--------|------------------|-------------|------|
| 00:00 ~ 06:00 | 10 ~ 30명 | 매우 낮음 | 최소 운영 |
| 06:00 ~ 09:00 | 30 ~ 50명 | 낮음 | 출근 전 체크 |
| 09:00 ~ 12:00 | 50 ~ 100명 | 보통 | 업무 중 간헐적 접속 |
| 12:00 ~ 14:00 | 100 ~ 150명 | 보통 | 점심시간 피크 |
| 14:00 ~ 18:00 | 80 ~ 120명 | 보통 | 오후 업무 시간 |
| 18:00 ~ 19:00 | 150 ~ 300명 | 높음 | 퇴근 시간대 상승 |
| 19:00 ~ 22:00 | 300 ~ 500명 | 매우 높음 | 일일 최대 트래픽 |
| 22:00 ~ 24:00 | 100 ~ 200명 | 높음 | 점진적 감소 |

### 주간/월간 패턴

#### 요일별 특징
- **월~목**: 안정적인 패턴
- **금요일**: 주말 준비로 트래픽 증가
- **토요일**: 오후~저녁 시간대 높은 트래픽
- **일요일**: 저녁 시간대 집중

#### 월별 특징
- **급여일 직후**: 트래픽 증가
- **명절 전후**: 특수 이벤트로 트래픽 급증
- **월말/월초**: 정산 및 프로모션으로 트래픽 증가

---

## 🎯 Auto Scaling 목표 및 기대효과

### 목표
1. **서비스 안정성**: 99.9% 가용성 목표
2. **응답 속도**: p95 기준 400ms 이하 유지
3. **비용 최적화**: 필요한 만큼만 리소스 사용
4. **사용자 경험**: 트래픽 변화에도 일관된 성능 제공

### 기대효과

#### 성능 측면
- 피크 타임 대응력 향상
- 응답 시간 안정화
- 서비스 중단 최소화

#### 비용 측면
- 저트래픽 시간대 비용 절감 (예상 40~50%)
- 필요 시에만 확장하는 탄력적 운영
- 리소스 활용률 최적화

#### 운영 측면
- 수동 개입 최소화
- 예측 가능한 운영 패턴
- 장애 대응 시간 단축

---

## 🔄 스케일링 동작 원리

### Scale-out 프로세스
1. **모니터링**: CloudWatch가 CPU 사용률 50% 초과 감지
2. **알람 발생**: Auto Scaling 정책 트리거
3. **인스턴스 시작**: Launch Template 기반 새 인스턴스 생성
4. **헬스체크**: ALB가 새 인스턴스 헬스체크 수행
5. **트래픽 유입**: 헬스체크 통과 후 트래픽 분산 시작

**소요 시간**: 약 2~3분 (AMI 준비 상태에 따라 변동)

### Scale-in 프로세스
1. **모니터링**: CloudWatch가 CPU 사용률 30% 이하 감지
2. **대기 시간**: 5분간 조건 유지 확인 (잦은 변동 방지)
3. **인스턴스 선택**: 가장 오래된 인스턴스 또는 AZ 밸런싱 고려
4. **연결 종료**: 진행 중인 연결 완료 대기 (Connection Draining)
5. **인스턴스 종료**: 안전하게 인스턴스 제거

**소요 시간**: 약 5~10분 (드레이닝 시간 포함)

---

## ⚠️ 주의사항 및 모범 사례

### 주의사항
1. **최소 인스턴스 유지**: 절대 1대로 줄이지 말것
2. **급격한 변화 방지**: Scale-in 시 쿨다운 타임 설정
3. **헬스체크 임계값**: 너무 짧으면 정상 인스턴스도 제거 위험
4. **AMI 최신화**: 정기적인 AMI 업데이트로 부팅 시간 단축

### 모범 사례
1. **로그 중앙화**: CloudWatch Logs로 모든 로그 수집
2. **알림 설정**: 스케일링 이벤트 발생 시 알림
3. **정기 검토**: 월 1회 트래픽 패턴 분석 및 스케줄 조정
4. **비용 모니터링**: AWS Cost Explorer로 비용 추이 확인

---

## 📊 성과 측정 지표

### 기술 지표
- **평균 응답 시간**: 목표 < 400ms
- **에러율**: 목표 < 0.1%
- **가용성**: 목표 > 99.9%
- **Auto Scaling 반응 시간**: 목표 < 3분

### 비즈니스 지표
- **페이지 로딩 시간**: 목표 < 2초
- **체크아웃 성공률**: 목표 > 98.5%
- **월간 비용**: 예상 대비 실제 비용
- **사용자 만족도**: 응답 속도 관련 피드백

---

## 🚀 향후 개선 방향

### 단기 (1~3개월)
- [ ] 실제 트래픽 데이터 기반 스케줄 미세 조정
- [ ] 예측 스케일링(Predictive Scaling) 도입 검토
- [ ] 더 세밀한 시간대 구분 (30분 단위)

### 중기 (3~6개월)
- [ ] 머신러닝 기반 트래픽 예측
- [ ] 여러 메트릭 조합 (CPU + 메모리 + 네트워크)
- [ ] 지역별 트래픽 패턴 분석

### 장기 (6개월 이상)
- [ ] 컨테이너 기반 아키텍처 전환 (ECS/EKS)
- [ ] 서버리스 아키텍처 도입 검토
- [ ] 글로벌 확장 대비 Multi-Region 구성

---

## 📚 참고 자료

### AWS 문서
- [Amazon EC2 Auto Scaling 사용 설명서](https://docs.aws.amazon.com/autoscaling/)
- [Application Load Balancer 설명서](https://docs.aws.amazon.com/elasticloadbalancing/)
- [CloudWatch 경보를 사용한 Auto Scaling](https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-instance-monitoring.html)

### 모범 사례
- AWS Well-Architected Framework
- Auto Scaling 모범 사례 가이드
- 비용 최적화 전략
